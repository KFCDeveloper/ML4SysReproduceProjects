INET_INCLUDES="-I${INET_HOME}/src \
-I${INET_HOME}/src/base \
-I${INET_HOME}/src/linklayer/contract \
-I${INET_HOME}/src/linklayer/ethernet \
-I${INET_HOME}/src/networklayer/arp \
-I${INET_HOME}/src/networklayer/common \
-I${INET_HOME}/src/networklayer/contract \
-I${INET_HOME}/src/networklayer/ipv4 \
-I${INET_HOME}/src/transport/contract \
-I${INET_HOME}/src/transport/udp \
-I${INET_HOME}/src/transport/tcp \
-I${INET_HOME}/src/transport/tcp_common \
-I${INET_HOME}/src/status \
-I${INET_HOME}/src/util \
-I${INET_HOME}/src \
-I${INET_HOME}/src/applications \
-I${INET_HOME}/src/applications/backbone \
-I${INET_HOME}/src/applications/common \
-I${INET_HOME}/src/applications/dhcp \
-I${INET_HOME}/src/applications/ethernet \
-I${INET_HOME}/src/applications/generic \
-I${INET_HOME}/src/applications/httptools \
-I${INET_HOME}/src/applications/pingapp \
-I${INET_HOME}/src/applications/rtpapp \
-I${INET_HOME}/src/applications/sctpapp \
-I${INET_HOME}/src/applications/tcpapp \
-I${INET_HOME}/src/applications/traci \
-I${INET_HOME}/src/applications/udpapp \
-I${INET_HOME}/src/applications/voip \
-I${INET_HOME}/src/base \
-I${INET_HOME}/src/battery \
-I${INET_HOME}/src/battery/models \
-I${INET_HOME}/src/linklayer \
-I${INET_HOME}/src/linklayer/common \
-I${INET_HOME}/src/linklayer/configurator \
-I${INET_HOME}/src/linklayer/contract \
-I${INET_HOME}/src/linklayer/ethernet \
-I${INET_HOME}/src/linklayer/ethernet/switch \
-I${INET_HOME}/src/linklayer/ext \
-I${INET_HOME}/src/linklayer/idealwireless \
-I${INET_HOME}/src/linklayer/ieee80211 \
-I${INET_HOME}/src/linklayer/ieee80211/mac \
-I${INET_HOME}/src/linklayer/ieee80211/mgmt \
-I${INET_HOME}/src/linklayer/ieee80211/radio \
-I${INET_HOME}/src/linklayer/ieee80211/radio/errormodel \
-I${INET_HOME}/src/linklayer/ieee8021d \
-I${INET_HOME}/src/linklayer/ieee8021d/common \
-I${INET_HOME}/src/linklayer/ieee8021d/relay \
-I${INET_HOME}/src/linklayer/ieee8021d/rstp \
-I${INET_HOME}/src/linklayer/ieee8021d/stp \
-I${INET_HOME}/src/linklayer/ieee8021d/tester \
-I${INET_HOME}/src/linklayer/loopback \
-I${INET_HOME}/src/linklayer/ppp \
-I${INET_HOME}/src/linklayer/queue \
-I${INET_HOME}/src/linklayer/radio \
-I${INET_HOME}/src/linklayer/radio/propagation \
-I${INET_HOME}/src/mobility \
-I${INET_HOME}/src/mobility/common \
-I${INET_HOME}/src/mobility/contract \
-I${INET_HOME}/src/mobility/group \
-I${INET_HOME}/src/mobility/single \
-I${INET_HOME}/src/mobility/static \
-I${INET_HOME}/src/networklayer \
-I${INET_HOME}/src/networklayer/arp \
-I${INET_HOME}/src/networklayer/autorouting \
-I${INET_HOME}/src/networklayer/autorouting/ipv4 \
-I${INET_HOME}/src/networklayer/autorouting/ipv6 \
-I${INET_HOME}/src/networklayer/bgpv4 \
-I${INET_HOME}/src/networklayer/bgpv4/BGPMessage \
-I${INET_HOME}/src/networklayer/common \
-I${INET_HOME}/src/networklayer/contract \
-I${INET_HOME}/src/networklayer/diffserv \
-I${INET_HOME}/src/networklayer/icmpv6 \
-I${INET_HOME}/src/networklayer/internetcloud \
-I${INET_HOME}/src/networklayer/ipv4 \
-I${INET_HOME}/src/networklayer/ipv6 \
-I${INET_HOME}/src/networklayer/ipv6tunneling \
-I${INET_HOME}/src/networklayer/ldp \
-I${INET_HOME}/src/networklayer/manetrouting \
-I${INET_HOME}/src/networklayer/manetrouting/aodv-uu \
-I${INET_HOME}/src/networklayer/manetrouting/aodv-uu/aodv-uu \
-I${INET_HOME}/src/networklayer/manetrouting/base \
-I${INET_HOME}/src/networklayer/manetrouting/batman \
-I${INET_HOME}/src/networklayer/manetrouting/batman/batmand \
-I${INET_HOME}/src/networklayer/manetrouting/batman/batmand/orig \
-I${INET_HOME}/src/networklayer/manetrouting/dsdv \
-I${INET_HOME}/src/networklayer/manetrouting/dsr \
-I${INET_HOME}/src/networklayer/manetrouting/dsr/dsr-uu \
-I${INET_HOME}/src/networklayer/manetrouting/dymo \
-I${INET_HOME}/src/networklayer/manetrouting/dymo/dymoum \
-I${INET_HOME}/src/networklayer/manetrouting/dymo_fau \
-I${INET_HOME}/src/networklayer/manetrouting/olsr \
-I${INET_HOME}/src/networklayer/mpls \
-I${INET_HOME}/src/networklayer/ospfv2 \
-I${INET_HOME}/src/networklayer/ospfv2/interface \
-I${INET_HOME}/src/networklayer/ospfv2/messagehandler \
-I${INET_HOME}/src/networklayer/ospfv2/neighbor \
-I${INET_HOME}/src/networklayer/ospfv2/router \
-I${INET_HOME}/src/networklayer/routing \
-I${INET_HOME}/src/networklayer/routing/aodv \
-I${INET_HOME}/src/networklayer/routing/dymo \
-I${INET_HOME}/src/networklayer/routing/gpsr \
-I${INET_HOME}/src/networklayer/routing/rip \
-I${INET_HOME}/src/networklayer/rsvp_te \
-I${INET_HOME}/src/networklayer/ted \
-I${INET_HOME}/src/networklayer/xmipv6 \
-I${INET_HOME}/src/nodes \
-I${INET_HOME}/src/nodes/aodv \
-I${INET_HOME}/src/nodes/bgp \
-I${INET_HOME}/src/nodes/dymo \
-I${INET_HOME}/src/nodes/ethernet \
-I${INET_HOME}/src/nodes/gpsr \
-I${INET_HOME}/src/nodes/httptools \
-I${INET_HOME}/src/nodes/inet \
-I${INET_HOME}/src/nodes/internetcloud \
-I${INET_HOME}/src/nodes/ipv6 \
-I${INET_HOME}/src/nodes/mpls \
-I${INET_HOME}/src/nodes/ospfv2 \
-I${INET_HOME}/src/nodes/rip \
-I${INET_HOME}/src/nodes/rtp \
-I${INET_HOME}/src/nodes/wireless \
-I${INET_HOME}/src/nodes/xmipv6 \
-I${INET_HOME}/src/status \
-I${INET_HOME}/src/transport \
-I${INET_HOME}/src/transport/contract \
-I${INET_HOME}/src/transport/rtp \
-I${INET_HOME}/src/transport/rtp/profiles \
-I${INET_HOME}/src/transport/rtp/profiles/avprofile \
-I${INET_HOME}/src/transport/sctp \
-I${INET_HOME}/src/transport/tcp \
-I${INET_HOME}/src/transport/tcp/flavours \
-I${INET_HOME}/src/transport/tcp/queues \
-I${INET_HOME}/src/transport/tcp_common \
-I${INET_HOME}/src/transport/udp \
-I${INET_HOME}/src/util \
-I${INET_HOME}/src/util/headerserializers \
-I${INET_HOME}/src/util/headerserializers/headers \
-I${INET_HOME}/src/util/headerserializers/ipv4 \
-I${INET_HOME}/src/util/headerserializers/ipv4/headers \
-I${INET_HOME}/src/util/headerserializers/ipv6 \
-I${INET_HOME}/src/util/headerserializers/ipv6/headers \
-I${INET_HOME}/src/util/headerserializers/sctp \
-I${INET_HOME}/src/util/headerserializers/sctp/headers \
-I${INET_HOME}/src/util/headerserializers/tcp \
-I${INET_HOME}/src/util/headerserializers/tcp/headers \
-I${INET_HOME}/src/util/headerserializers/udp \
-I${INET_HOME}/src/util/headerserializers/udp/headers \
-I${INET_HOME}/src/util/messageprinters \
-I${INET_HOME}/src/world \
-I${INET_HOME}/src/world/annotations \
-I${INET_HOME}/src/world/httptools \
-I${INET_HOME}/src/world/obstacles \
-I${INET_HOME}/src/world/radio \
-I${INET_HOME}/src/world/scenario \
-I${INET_HOME}/src/world/traci \
"

opp_makemake -f --deep --make-so -X test -o homatransport -O out -pHOMA ${INET_INCLUDES}

if [ -z "$1" ]; then
    MODE=release
else
    MODE="$1"
fi

make CFLAGS+="-g -std=c++14 -fPIC -Wno-deprecated-declarations" LDFLAGS+="-Wl,--allow-shlib-undefined" MODE=${MODE}
